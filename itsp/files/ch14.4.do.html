<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<!-- Generated by statdoc (version v0.9.2-beta) on 2015-09-23 10:12:38 -->
<head>
<meta charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<title>itsp</title>
<meta name="date" content="2015-09-23">
<script src="../d3.min.js"></script>
<script src="../statdoc.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ========= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li ><a href="../overview/overview-summary.html"  target="classFrame">Overview</a></li>
<li ><a href="../variables/variables-summary.html"  target="classFrame">Variables</a></li>
<li  class="navBarCell1Rev"><a href="../files/files-summary.html"  target="classFrame">Files</a></li>
<li ><a href="../tokens/tokens-summary.html"  target="classFrame">Tokens</a></li>
<!-- <li><a href="../flows/flow-summary.html"  target="classFrame">Flows</a></li> -->
<li ><a href="../overview/help-doc.html"  target="classFrame">Help</a></li>
<!-- <li class="navBarCell1Rev">Active</li> -->
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>
	<a href="../files/ch14.3.do.html" title="ch14.3.do">Prev</a>	
	</li>
<li>
    <a href="../files/ch14.7.do.html" title="ch14.7.do">Next</a>   
    </li>
</ul>
<ul class="navList">
<li><a href="../compare.html?files/ch14.4.do.html" target="_top">Compare</a></li>
<li><a href="../index.html?files/ch14.4.do.html" target="_top">Frames</a></li>
<li><a href="../files/ch14.4.do.html" target="_top">No Frames</a></li>
</ul>


<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= --><!-- ======== START OF FILE DATA ======== -->
<div class="header">
<div class="subTitle">itsp</div>
<h2 title="Statdoc File ch14.4.do" class="title">File ch14.4.do</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>
<table border="0" style="border-collapse: collapse;table-layout: auto;width: auto;">
  <colgroup>
    <col span="1" width="200px">
    <col width="10px" style="text-align:center;">
    <col width="200px">
    <col width="10px" style="text-align:center;">
    <col span="1" width="200px">
  </colgroup>
<tr class="inheritance">
	<!-- DEBUG match109_hash_-328161135 -->
<!-- DEBUG [urates.dta] -->
<td style="text-align:right;">
    

</td>
<td colspan="1" style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#109" title="ch14.4.do:109 (use)">109</a>]&nbsp;</i>
</td>  

      <td style="white-space: nowrap; background: #eeeeff;">
    <a href="../files/urates.dta.html" title="urates.dta"  target="classFrame" >urates.dta</a>
</td>  
</tr>
<tr class="inheritance">
<td style="border: none;"></td>
<td style="text-align:center;background: #ffffee;">&rarr;</td>
<td  style="background: #ffffee;">
<span style="background: #ffffee;"><b>ch14.4.do</b></span>
</td>
<td style="text-align:center;background: #ffffee;">&#8600;</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [aggreg2mata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../files/ch14.4.do.html#108" title="aggreg2mata"  target="classFrame" >aggreg2mata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#108" title="ch14.4.do:108 (do)">108</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [countrymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/c.html#countrymata" title="countrymata"  target="classFrame" >countrymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#126" title="ch14.4.do:126 (do)">126</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [loadctymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/l.html#loadctymata" title="loadctymata"  target="classFrame" >loadctymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#130" title="ch14.4.do:130 (do)">130</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [compctymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/c.html#compctymata" title="compctymata"  target="classFrame" >compctymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#134" title="ch14.4.do:134 (do)">134</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [countrymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/c.html#countrymata" title="countrymata"  target="classFrame" >countrymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#139" title="ch14.4.do:139 (do)">139</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [loadctymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/l.html#loadctymata" title="loadctymata"  target="classFrame" >loadctymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#140" title="ch14.4.do:140 (do)">140</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [compctymata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../tokens/c.html#compctymata" title="compctymata"  target="classFrame" >compctymata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#141" title="ch14.4.do:141 (do)">141</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
<tr class="inheritance">
<!-- DEBUG [compcty2mata] -->
<td colspan="2" style="border: none;"></td>

<td style="text-align:right; background:  #ffffff ;" colspan="1">
      <span style="white-space: nowrap; background: #ffffff;">
    <a href="../files/ch14.4.do.html#163" title="compcty2mata"  target="classFrame" >compcty2mata</a><br>
</span>  
</td> 
<td style="text-align:center; background: #ffffee;">

<i>&nbsp;[<a href="../files/ch14.4.do.html#163" title="ch14.4.do:163 (do)">163</a>]&nbsp;</i>
</td>
<td>

</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>

<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><span class="strong">ch14.4.do <a href="../ch14.4.do">open</a></span>
file:script:do</pre>
</li>
</ul>

</div>
<ul class="blockList">
<li class="blockList">
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">date</td>
  <td class="colLast">Wed Sep 23 21:31:39 EST 2015</td>
  </tr>
    </tbody>
  </table>
</li>
</ul>




<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Variable Summary table, listing datasets and labels">
<caption><span><a name="variables"><!-- --></a>All commands</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" style="width:30px" scope="col">#</th>
<th class="colLast" width="100%" scope="col">content
<!-- <span style="float: right;">&nbsp;<a title="Raw Source" onclick="toggle('rawframe');setIframeHeight('rawframe');">raw</a> -->
</th>
<!--
<td style="display:none;" id="rawframe" rowspan="78" height="100%">
<iframe scrolling="yes" width="600px" height="100%" src="../files/ch14.4.do.html#content" name="statdocSubFrame_raw" title="Raw File" style="height: 100%; width: 600px; overflow-x:scroll; overflow-y:scroll; -ms-overflow-x:scroll; -ms-overflow-y:scroll;"></iframe>
</td>
-->
</tr>
 <tr class="cmd_comment altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="1" title="comment"><!-- -->
    1</a>&nbsp;<a onclick='toggle("cmd_526294316");' title="comment">[+]</a>
</td>
<td class="colLast" style="padding-left:${ind}em">
  <span class="cmdcomment">* ITSP 14.4 -</span>
<div id="cmd_526294316" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">* ITSP 14.4 -</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">* ITSP 14.4 -</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="3" title="program"><!-- -->
    3</a>&nbsp;<a onclick='toggle("cmd_1788067596");' title="program">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">program</span>
  <span class="cmdparameters"><a href="../variables/drop.html">drop</a> <a href="../tokens/_.html#_all">_all</a></span>
<div id="cmd_1788067596" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">program drop _all</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">program</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../variables/drop.html">drop</a> <a href="../tokens/_.html#_all">_all</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="4" title="mata"><!-- -->
    4</a>&nbsp;<a onclick='toggle("cmd_-501672453");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdprefix"><a href="../tokens/m.html#mata">mata</a>:</span>
 <span class="cmdcommand">mata</span>
  <span class="cmdparameters"> <a href="../tokens/c.html#clear">clear</a></span>
<div id="cmd_-501672453" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">mata: mata clear</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"> <a href="../tokens/c.html#clear">clear</a></td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">prefix</td>
  <td class="colLast"><a href="../tokens/m.html#mata">mata</a>:</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="6" title="type"><!-- -->
    6</a>&nbsp;<a onclick='toggle("cmd_1429297678");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/a.html#ado">ado</a></span>
<div id="cmd_1429297678" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type aggreg2.ado</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/a.html#ado">ado</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_comment altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="8" title="comment"><!-- -->
    8</a>&nbsp;<a onclick='toggle("cmd_1575325865");' title="comment">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
  <span class="cmdcomment">
/*
program aggreg, rclass
	version 10.1
	syntax varlist(max=1 numeric) [if] [in], per(integer) ///
	       [func(string) trans(string)]
	marksample touse
	quietly count if `touse'
	if `r(N)' == 0 {
	        error 2000
	}
* validate per versus selected sample
	if `per' <= 0 | `per' >= `r(N)' {
		display as error "per must be > 0 and < N of observations."
		error 198
	}
	if mod(`r(N)',`per' != 0) {
		display as error "N of observations must be a multiple of per."
		error 198
	}
* validate func option; default is average (code A)
    local ops A S F L
    local opnames average sum first last
    if "`func'" == "" {
    	local op  "A"
    }
    else {
    	local nop : list posof "`func'" in opnames
    	if !`nop' {
    		display as err "Error: func must be chosen from `opnames'"
    		error 198
    	}
    	local op : word `nop' of `ops'
    }
* validate trans option; default is none (identity)
    local trops abs exp log sqrt  
    local trnames mf_abs mf_exp mf_log mf_sqrt
    if "`trans'" == "" {
    	local trop  ""
    	local trfn  "mf_iden"
    }
    else {
    	local ntr : list posof "`trans'" in trops
    	if !`ntr' {
    		display as err "Error: trans must be chosen from `trops'"
    		error 198
    	}
    	local trop : word `ntr' of `trops'
    	local trfn : word `ntr' of `trnames'
    }
* validate the new varname
	local newvar = "`varlist'`op'`trop'`per'"
	quietly generate `newvar' = .
* pass the varname and newvarname to Mata
	mata: aggreg2("`varlist'", "`newvar'",  `per', "`op'", ///
	      &`trfn'(), "`touse'")
	end
*/</span>
<div id="cmd_1575325865" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
/*
program aggreg, rclass
	version 10.1
	syntax varlist(max=1 numeric) [if] [in], per(integer) ///
	       [func(string) trans(string)]
	marksample touse
	quietly count if `touse'
	if `r(N)' == 0 {
	        error 2000
	}
* validate per versus selected sample
	if `per' <= 0 | `per' >= `r(N)' {
		display as error "per must be > 0 and < N of observations."
		error 198
	}
	if mod(`r(N)',`per' != 0) {
		display as error "N of observations must be a multiple of per."
		error 198
	}
* validate func option; default is average (code A)
    local ops A S F L
    local opnames average sum first last
    if "`func'" == "" {
    	local op  "A"
    }
    else {
    	local nop : list posof "`func'" in opnames
    	if !`nop' {
    		display as err "Error: func must be chosen from `opnames'"
    		error 198
    	}
    	local op : word `nop' of `ops'
    }
* validate trans option; default is none (identity)
    local trops abs exp log sqrt  
    local trnames mf_abs mf_exp mf_log mf_sqrt
    if "`trans'" == "" {
    	local trop  ""
    	local trfn  "mf_iden"
    }
    else {
    	local ntr : list posof "`trans'" in trops
    	if !`ntr' {
    		display as err "Error: trans must be chosen from `trops'"
    		error 198
    	}
    	local trop : word `ntr' of `trops'
    	local trfn : word `ntr' of `trnames'
    }
* validate the new varname
	local newvar = "`varlist'`op'`trop'`per'"
	quietly generate `newvar' = .
* pass the varname and newvarname to Mata
	mata: aggreg2("`varlist'", "`newvar'",  `per', "`op'", ///
	      &`trfn'(), "`touse'")
	end
*/</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">comment</td>
  <td class="colLast">
/*
program aggreg, rclass
	version 10.1
	syntax varlist(max=1 numeric) [if] [in], per(integer) ///
	       [func(string) trans(string)]
	marksample touse
	quietly count if `touse'
	if `r(N)' == 0 {
	        error 2000
	}
* validate per versus selected sample
	if `per' <= 0 | `per' >= `r(N)' {
		display as error "per must be > 0 and < N of observations."
		error 198
	}
	if mod(`r(N)',`per' != 0) {
		display as error "N of observations must be a multiple of per."
		error 198
	}
* validate func option; default is average (code A)
    local ops A S F L
    local opnames average sum first last
    if "`func'" == "" {
    	local op  "A"
    }
    else {
    	local nop : list posof "`func'" in opnames
    	if !`nop' {
    		display as err "Error: func must be chosen from `opnames'"
    		error 198
    	}
    	local op : word `nop' of `ops'
    }
* validate trans option; default is none (identity)
    local trops abs exp log sqrt  
    local trnames mf_abs mf_exp mf_log mf_sqrt
    if "`trans'" == "" {
    	local trop  ""
    	local trfn  "mf_iden"
    }
    else {
    	local ntr : list posof "`trans'" in trops
    	if !`ntr' {
    		display as err "Error: trans must be chosen from `trops'"
    		error 198
    	}
    	local trop : word `ntr' of `trops'
    	local trfn : word `ntr' of `trnames'
    }
* validate the new varname
	local newvar = "`varlist'`op'`trop'`per'"
	quietly generate `newvar' = .
* pass the varname and newvarname to Mata
	mata: aggreg2("`varlist'", "`newvar'",  `per', "`op'", ///
	      &`trfn'(), "`touse'")
	end
*/</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="66" title="type"><!-- -->
    66</a>&nbsp;<a onclick='toggle("cmd_-838135839");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-838135839" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type aggreg2.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr>
<td class="colFirst" style="width:30px"></td>
<td class="colLast" style="padding-left:0em"><div class="cmd_comment"> /* version 10.1</div></td>
</tr>
<tr class="cmd_mata altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="70" title="mata"><!-- -->
    70</a>&nbsp;<a onclick='toggle("cmd_-1382926829");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (36 lines)</span>
<div id="cmd_-1382926829" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata:
function mf_abs(x) return(abs(x))
function mf_exp(x) return(exp(x))
function mf_log(x) return(log(x))
function mf_sqrt(x) return(sqrt(x))
function mf_iden(x) return(x)

void aggreg(string scalar vname,
		string scalar newvname,
		real scalar per,
		string scalar op,
		pointer(real scalar function) scalar f,
		string scalar touse)
{
	real colvector mult
	if (op == "A") {
	     mult = J(per, 1, 1/per)
	}
	else if (op == "S") {
	     mult = J(per, 1, 1)
	}
	else if (op == "F") {
		 mult = J(per, 1, 0)
		 mult[1] = 1
	}
	else if (op == "L") {
	     mult = J(per, 1, 0)
	     mult[per] = 1
	}
	st_view(v1=., ., vname, touse)
	v1t = (*f)(v1)
	st_view(v2=., ., newvname)
	v3 = colshape(v1t', per) * mult
	v2[(1::rows(v3)),] = v3
}
end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (36 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_comment rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="106" title="comment"><!-- -->
    106</a>&nbsp;<a onclick='toggle("cmd_1663461078");' title="comment">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
  <span class="cmdcomment">*/</span>
<div id="cmd_1663461078" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">*/</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">comment</td>
  <td class="colLast">*/</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="108" title="do"><!-- -->
    108</a>&nbsp;<a onclick='toggle("cmd_86290884");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_86290884" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do aggreg2.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/a.html#aggreg2">aggreg2</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_importcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="109" title="use"><!-- -->
    109</a>&nbsp;<a onclick='toggle("cmd_1953752913");' title="use">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">use</span>
  <span class="cmdparameters"><a href="../tokens/u.html#urates">urates</a></span>
, <span class="cmdoptions"> <a href="../tokens/c.html#clear">clear</a></span>
<div id="cmd_1953752913" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">use urates, clear</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">use</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/c.html#clear">clear</a></td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/u.html#urates">urates</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="110" title="aggreg2"><!-- -->
    110</a>&nbsp;<a onclick='toggle("cmd_-1992069895");' title="aggreg2">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">aggreg2</span>
  <span class="cmdparameters"><a href="../variables/tenn.html">tenn</a></span>
, <span class="cmdoptions"> <a href="../tokens/p.html#per">per(</a>3) <a href="../tokens/t.html#trans">trans(</a><a href="../tokens/l.html#log">log</a>)</span>
  <span class="cmdcomment">// calculate quarterly averages of log(tenn)</span>
<div id="cmd_-1992069895" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">aggreg2 tenn, per(3) trans(log) // calculate quarterly averages of log(tenn)</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">aggreg2</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">// calculate quarterly averages of log(tenn)</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/p.html#per">per(</a>3) <a href="../tokens/t.html#trans">trans(</a><a href="../tokens/l.html#log">log</a>)</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../variables/tenn.html">tenn</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="111" title="aggreg2"><!-- -->
    111</a>&nbsp;<a onclick='toggle("cmd_-1729548473");' title="aggreg2">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">aggreg2</span>
  <span class="cmdparameters"><a href="../variables/tenn.html">tenn</a></span>
, <span class="cmdoptions"> <a href="../tokens/p.html#per">per(</a>3) <a href="../tokens/f.html#func">func(</a><a href="../tokens/s.html#sum">sum</a>) <a href="../tokens/t.html#trans">trans(</a><a href="../tokens/s.html#sqrt">sqrt</a>)</span>
  <span class="cmdcomment">// calculate quarterly sum of sqrt(tenn)</span>
<div id="cmd_-1729548473" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">aggreg2 tenn, per(3) func(sum) trans(sqrt) // calculate quarterly sum of sqrt(tenn)</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">aggreg2</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">comment</td>
  <td class="colLast">// calculate quarterly sum of sqrt(tenn)</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/p.html#per">per(</a>3) <a href="../tokens/f.html#func">func(</a><a href="../tokens/s.html#sum">sum</a>) <a href="../tokens/t.html#trans">trans(</a><a href="../tokens/s.html#sqrt">sqrt</a>)</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../variables/tenn.html">tenn</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="112" title="tsmktim"><!-- -->
    112</a>&nbsp;<a onclick='toggle("cmd_-499850081");' title="tsmktim">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">tsmktim</span>
  <span class="cmdparameters"><a href="../tokens/q.html#quarter">quarter</a></span>
, <span class="cmdoptions"> <a href="../tokens/s.html#start">start(</a><a href="../tokens/1.html#1978q1">1978q1</a>)</span>
  <span class="cmdcomment">// create quarterly calendar var</span>
<div id="cmd_-499850081" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">tsmktim quarter, start(1978q1) // create quarterly calendar var</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">tsmktim</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">// create quarterly calendar var</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/s.html#start">start(</a><a href="../tokens/1.html#1978q1">1978q1</a>)</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/q.html#quarter">quarter</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_statcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="113" title="list"><!-- -->
    113</a>&nbsp;<a onclick='toggle("cmd_-122547299");' title="list">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">list</span>
  <span class="cmdparameters">t <a href="../variables/tenn.html">tenn</a> <a href="../tokens/q.html#quarter">quarter</a> <a href="../files/ch14.4.do.html#113">tennAlog3</a> <a href="../files/ch14.4.do.html#113">tennSsqrt3</a></span>
in <span class="cmdin">1/12</span>
, <span class="cmdoptions"> <a href="../tokens/s.html#sep">sep(</a>3)</span>
<div id="cmd_-122547299" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">list t tenn quarter tennAlog3 tennSsqrt3 in 1/12, sep(3)</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">list</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">in</td>
  <td class="colLast">1/12</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/s.html#sep">sep(</a>3)</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">t <a href="../variables/tenn.html">tenn</a> <a href="../tokens/q.html#quarter">quarter</a> <a href="../files/ch14.4.do.html#113">tennAlog3</a> <a href="../files/ch14.4.do.html#113">tennSsqrt3</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="115" title="clear"><!-- -->
    115</a>&nbsp;<a onclick='toggle("cmd_1443444133");' title="clear">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">clear</span>
  <span class="cmdparameters"></span>
<div id="cmd_1443444133" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">clear</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">clear</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="116" title="sysuse"><!-- -->
    116</a>&nbsp;<a onclick='toggle("cmd_-526639706");' title="sysuse">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">sysuse</span>
  <span class="cmdparameters"><a href="../tokens/a.html#auto">auto</a></span>
<div id="cmd_-526639706" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">sysuse auto</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">sysuse</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/a.html#auto">auto</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_manipulate altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="117" title="generate"><!-- -->
    117</a>&nbsp;<a onclick='toggle("cmd_-749939945");' title="generate">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">generate</span>
  <span class="cmdparameters"><a href="../files/ch14.4.do.html#117">en</a> = <a href="../tokens/_.html#_n">_n</a></span>
<div id="cmd_-749939945" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">generate en = _n</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">generate</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../files/ch14.4.do.html#117">en</a> = <a href="../tokens/_.html#_n">_n</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_mata rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="118" title="mata"><!-- -->
    118</a>&nbsp;<a onclick='toggle("cmd_-249764631");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (6 lines)</span>
<div id="cmd_-249764631" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata:
st_view(Z1=., ., ("en", "price", "mpg", "turn"), 0)
st_view(Z2=., ., ("en", "weight", "length", "rep78"), 0)
Z1[ 6, .]
Z2[ 6, .]
end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (6 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="125" title="mata"><!-- -->
    125</a>&nbsp;<a onclick='toggle("cmd_874591634");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdprefix"><a href="../tokens/m.html#mata">mata</a>:</span>
 <span class="cmdcommand">mata</span>
  <span class="cmdparameters"> <a href="../tokens/c.html#clear">clear</a></span>
<div id="cmd_874591634" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">mata: mata clear</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"> <a href="../tokens/c.html#clear">clear</a></td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">prefix</td>
  <td class="colLast"><a href="../tokens/m.html#mata">mata</a>:</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="126" title="do"><!-- -->
    126</a>&nbsp;<a onclick='toggle("cmd_-1469617256");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-1469617256" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do country.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="128" title="type"><!-- -->
    128</a>&nbsp;<a onclick='toggle("cmd_1333530444");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_1333530444" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type country.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="130" title="do"><!-- -->
    130</a>&nbsp;<a onclick='toggle("cmd_-1945801819");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-1945801819" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do loadcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="132" title="type"><!-- -->
    132</a>&nbsp;<a onclick='toggle("cmd_1144685164");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_1144685164" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type loadcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="134" title="do"><!-- -->
    134</a>&nbsp;<a onclick='toggle("cmd_-1591968460");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-1591968460" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do compcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="136" title="type"><!-- -->
    136</a>&nbsp;<a onclick='toggle("cmd_-2029983345");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-2029983345" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type compcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="139" title="do"><!-- -->
    139</a>&nbsp;<a onclick='toggle("cmd_1376318921");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_1376318921" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do country.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#country">country</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="140" title="do"><!-- -->
    140</a>&nbsp;<a onclick='toggle("cmd_659498802");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_659498802" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do loadcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/l.html#loadcty">loadcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="141" title="do"><!-- -->
    141</a>&nbsp;<a onclick='toggle("cmd_1404789444");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_1404789444" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do compcty.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#compcty">compcty</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_mata altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="142" title="mata"><!-- -->
    142</a>&nbsp;<a onclick='toggle("cmd_599756863");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (7 lines)</span>
<div id="cmd_599756863" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata: 
addr1 = loadcty("US", "United States", 301.139947, 43800,"Washington DC", 38, 53, -77, -02)
addr2 = loadcty("CA", "Canada", 33.390141, 35700, "Ottawa", 45, 24, -75, -43)
addr3 = loadcty("TR", "Turkey", 71.158647, 9100, "Ankara", 39, 55, 32, 55)
addr4 = loadcty("AR", "Argentina", 40.301927, 15200, "Buenos Aires", -34, -35, 58, 22)
addr5 = loadcty("JP", "Japan", 127.433494, 33100, "Tokyo", 35, 40, 139, 45)
end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (7 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="149" title="clear"><!-- -->
    149</a>&nbsp;<a onclick='toggle("cmd_1382506984");' title="clear">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">clear</span>
  <span class="cmdparameters"></span>
<div id="cmd_1382506984" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">clear</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">clear</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="150" title="set"><!-- -->
    150</a>&nbsp;<a onclick='toggle("cmd_1470915467");' title="set">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">set</span>
  <span class="cmdparameters"><a href="../tokens/o.html#obs">obs</a> 1</span>
<div id="cmd_1470915467" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">set obs 1</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">set</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/o.html#obs">obs</a> 1</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_manipulate rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="151" title="generate"><!-- -->
    151</a>&nbsp;<a onclick='toggle("cmd_-72896158");' title="generate">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">generate</span>
  <span class="cmdparameters"><a href="../files/ch14.4.do.html#151">lat1</a> = .</span>
<div id="cmd_-72896158" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">generate lat1 = .</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">generate</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../files/ch14.4.do.html#151">lat1</a> = .</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_manipulate altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="152" title="generate"><!-- -->
    152</a>&nbsp;<a onclick='toggle("cmd_1835454385");' title="generate">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">generate</span>
  <span class="cmdparameters"><a href="../files/ch14.4.do.html#152">long1</a> = .</span>
<div id="cmd_1835454385" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">generate long1 = .</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">generate</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../files/ch14.4.do.html#152">long1</a> = .</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_manipulate rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="153" title="generate"><!-- -->
    153</a>&nbsp;<a onclick='toggle("cmd_36001029");' title="generate">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">generate</span>
  <span class="cmdparameters"><a href="../files/ch14.4.do.html#153">lat2</a> = .</span>
<div id="cmd_36001029" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">generate lat2 = .</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">generate</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../files/ch14.4.do.html#153">lat2</a> = .</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_manipulate altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="154" title="generate"><!-- -->
    154</a>&nbsp;<a onclick='toggle("cmd_1413780661");' title="generate">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">generate</span>
  <span class="cmdparameters"><a href="../files/ch14.4.do.html#154">long2</a> = .</span>
<div id="cmd_1413780661" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">generate long2 = .</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">generate</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../files/ch14.4.do.html#154">long2</a> = .</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_mata rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="156" title="mata"><!-- -->
    156</a>&nbsp;<a onclick='toggle("cmd_-151017127");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (6 lines)</span>
<div id="cmd_-151017127" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata: 
compcty(*addr1, *addr2)
compcty(*addr1, *addr3)
compcty(*addr3, *addr4)
compcty(*addr1, *addr5)
end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (6 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_runcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="163" title="do"><!-- -->
    163</a>&nbsp;<a onclick='toggle("cmd_-309879258");' title="do">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">do</span>
  <span class="cmdparameters"><a href="../tokens/c.html#compcty2">compcty2</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-309879258" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">do compcty2.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">do</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#compcty2">compcty2</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="165" title="type"><!-- -->
    165</a>&nbsp;<a onclick='toggle("cmd_-1531885694");' title="type">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">type</span>
  <span class="cmdparameters"><a href="../tokens/c.html#compcty2">compcty2</a>.<a href="../tokens/m.html#mata">mata</a></span>
<div id="cmd_-1531885694" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">type compcty2.mata</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">type</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#compcty2">compcty2</a>.<a href="../tokens/m.html#mata">mata</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_mata altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="167" title="mata"><!-- -->
    167</a>&nbsp;<a onclick='toggle("cmd_-326977782");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (4 lines)</span>
<div id="cmd_-326977782" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata:
compcty2(*addr1, *addr3)
compcty2(*addr3, *addr4)
end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (4 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
</table>
</li>
</ul>


<a name="content"><!--   --></a>
<!-- ========== CONTENT =========== -->
<ul class="blockList">
<li class="blockList">
<ul class="blockList">
<li class="blockList">
<h3>Content</h3>
<pre>
* ITSP 14.4 -

program drop _all
mata: mata clear

type aggreg2.ado

/*
program aggreg, rclass
	version 10.1
	syntax varlist(max=1 numeric) [if] [in], per(integer) ///
	       [func(string) trans(string)]
	marksample touse
	quietly count if `touse'
	if `r(N)' == 0 {
	        error 2000
	}
* validate per versus selected sample
	if `per' <= 0 | `per' >= `r(N)' {
		display as error "per must be > 0 and < N of observations."
		error 198
	}
	if mod(`r(N)',`per' != 0) {
		display as error "N of observations must be a multiple of per."
		error 198
	}
* validate func option; default is average (code A)
    local ops A S F L
    local opnames average sum first last
    if "`func'" == "" {
    	local op  "A"
    }
    else {
    	local nop : list posof "`func'" in opnames
    	if !`nop' {
    		display as err "Error: func must be chosen from `opnames'"
    		error 198
    	}
    	local op : word `nop' of `ops'
    }
* validate trans option; default is none (identity)
    local trops abs exp log sqrt  
    local trnames mf_abs mf_exp mf_log mf_sqrt
    if "`trans'" == "" {
    	local trop  ""
    	local trfn  "mf_iden"
    }
    else {
    	local ntr : list posof "`trans'" in trops
    	if !`ntr' {
    		display as err "Error: trans must be chosen from `trops'"
    		error 198
    	}
    	local trop : word `ntr' of `trops'
    	local trfn : word `ntr' of `trnames'
    }
* validate the new varname
	local newvar = "`varlist'`op'`trop'`per'"
	quietly generate `newvar' = .
* pass the varname and newvarname to Mata
	mata: aggreg2("`varlist'", "`newvar'",  `per', "`op'", ///
	      &`trfn'(), "`touse'")
	end
*/

type aggreg2.mata

/*
version 10.1
mata:
function mf_abs(x) return(abs(x))
function mf_exp(x) return(exp(x))
function mf_log(x) return(log(x))
function mf_sqrt(x) return(sqrt(x))
function mf_iden(x) return(x)

void aggreg(string scalar vname,
		string scalar newvname,
		real scalar per,
		string scalar op,
		pointer(real scalar function) scalar f,
		string scalar touse)
{
	real colvector mult
	if (op == "A") {
	     mult = J(per, 1, 1/per)
	}
	else if (op == "S") {
	     mult = J(per, 1, 1)
	}
	else if (op == "F") {
		 mult = J(per, 1, 0)
		 mult[1] = 1
	}
	else if (op == "L") {
	     mult = J(per, 1, 0)
	     mult[per] = 1
	}
	st_view(v1=., ., vname, touse)
	v1t = (*f)(v1)
	st_view(v2=., ., newvname)
	v3 = colshape(v1t', per) * mult
	v2[(1::rows(v3)),] = v3
}
end
*/

do aggreg2.mata
use urates, clear
aggreg2 tenn, per(3) trans(log) // calculate quarterly averages of log(tenn)
aggreg2 tenn, per(3) func(sum) trans(sqrt) // calculate quarterly sum of sqrt(tenn)
tsmktim quarter, start(1978q1) // create quarterly calendar var
list t tenn quarter tennAlog3 tennSsqrt3 in 1/12, sep(3)

clear
sysuse auto
generate en = _n
mata:
st_view(Z1=., ., ("en", "price", "mpg", "turn"), 0)
st_view(Z2=., ., ("en", "weight", "length", "rep78"), 0)
Z1[ 6, .]
Z2[ 6, .]
end

mata: mata clear
do country.mata

type country.mata

do loadcty.mata

type loadcty.mata

do compcty.mata

type compcty.mata


do country.mata
do loadcty.mata
do compcty.mata
mata: 
addr1 = loadcty("US", "United States", 301.139947, 43800,"Washington DC", 38, 53, -77, -02)
addr2 = loadcty("CA", "Canada", 33.390141, 35700, "Ottawa", 45, 24, -75, -43)
addr3 = loadcty("TR", "Turkey", 71.158647, 9100, "Ankara", 39, 55, 32, 55)
addr4 = loadcty("AR", "Argentina", 40.301927, 15200, "Buenos Aires", -34, -35, 58, 22)
addr5 = loadcty("JP", "Japan", 127.433494, 33100, "Tokyo", 35, 40, 139, 45)
end
clear
set obs 1
generate lat1 = .
generate long1 = .
generate lat2 = .
generate long2 = .

mata: 
compcty(*addr1, *addr2)
compcty(*addr1, *addr3)
compcty(*addr3, *addr4)
compcty(*addr1, *addr5)
end

do compcty2.mata

type compcty2.mata

mata:
compcty2(*addr1, *addr3)
compcty2(*addr3, *addr4)
end

</pre>
</li>
</ul>
</li>
</ul>


<ul class="blockList">
<li class="blockList">
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== TOKENS =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Tokens</h3>
</li>
</ul>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ========= START OF BOTTOM NAVBAR ========= -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li ><a href="../overview/overview-summary.html"  target="classFrame">Overview</a></li>
<li ><a href="../variables/variables-summary.html"  target="classFrame">Variables</a></li>
<li  class="navBarCell1Rev"><a href="../files/files-summary.html"  target="classFrame">Files</a></li>
<li ><a href="../tokens/tokens-summary.html"  target="classFrame">Tokens</a></li>
<!-- <li><a href="../flows/flow-summary.html"  target="classFrame">Flows</a></li> -->
<li ><a href="../overview/help-doc.html"  target="classFrame">Help</a></li>
<!-- <li class="navBarCell1Rev">Active</li> -->
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>
	<a href="../files/ch14.3.do.html" title="ch14.3.do">Prev</a>	
	</li>
<li>
    <a href="../files/ch14.7.do.html" title="ch14.7.do" >Next</a>   
    </li>
</ul>
<ul class="navList">
<li><a href="../index.html?files/ch14.4.do.html" target="_top">Frames</a></li>
<li><a href="../files/ch14.4.do.html" target="_top">No Frames</a></li>
</ul>


<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ========= END OF BOTTOM NAVBAR ========= -->
</body>
</html>