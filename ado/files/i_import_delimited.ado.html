<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<!-- Generated by statdoc (version v0.9.2-beta) on 2015-09-18 03:37:04 -->
<head>
<meta charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<title>base</title>
<meta name="date" content="2015-09-18">
<script src="../d3.min.js"></script>
<script src="../statdoc.js"></script>
</head>
<body>

<!-- ========= START OF TOP NAVBAR ========= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li ><a href="../overview/overview-summary.html"  target="classFrame">Overview</a></li>
<li ><a href="../variables/variables-summary.html"  target="classFrame">Variables</a></li>
<li  class="navBarCell1Rev"><a href="../files/files-summary.html"  target="classFrame">Files</a></li>
<li ><a href="../tokens/tokens-summary.html"  target="classFrame">Tokens</a></li>
<!-- <li><a href="../flows/flow-summary.html"  target="classFrame">Flows</a></li> -->
<li ><a href="../overview/help-doc.html"  target="classFrame">Help</a></li>
<!-- <li class="navBarCell1Rev">Active</li> -->
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>
	<a href="../files/i_import.sthlp.html" title="i/import.sthlp">Prev</a>	
	</li>
<li>
    <a href="../files/i_import_delimited.sthlp.html" title="i/import_delimited.sthlp">Next</a>   
    </li>
</ul>
<ul class="navList">
<li><a href="../compare.html?files/i_import_delimited.ado.html" target="_top">Compare</a></li>
<li><a href="../index.html?files/i_import_delimited.ado.html" target="_top">Frames</a></li>
<li><a href="../files/i_import_delimited.ado.html" target="_top">No Frames</a></li>
</ul>


<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= --><!-- ======== START OF FILE DATA ======== -->
<div class="header">
<div class="subTitle">base</div>
<h2 title="Statdoc File import_delimited.ado" class="title">File import_delimited.ado</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>
<table border="0" style="border-collapse: collapse;table-layout: auto;width: auto;">
  <colgroup>
    <col span="1" width="200px">
    <col width="10px" style="text-align:center;">
    <col width="200px">
    <col width="10px" style="text-align:center;">
    <col span="1" width="200px">
  </colgroup>
<tr class="inheritance">
<td style="border: none;"></td>
<td style="text-align:center;background: #eeeeee;">&rarr;</td>
<td  style="background: #eeeeee;">
<span style="background: #eeeeee;"><b>i/import_delimited.ado</b></span>
</td>
<td style="text-align:center;background: #eeeeee;">&#8600;</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>

<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><span class="strong">i/import_delimited.ado <a href="../i/import_delimited.ado">open</a></span>
file:script:ado</pre>
</li>
</ul>

</div>
<ul class="blockList">
<li class="blockList">
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">date</td>
  <td class="colLast">Sun Jun 02 03:10:50 AEST 2013</td>
  </tr>
    </tbody>
  </table>
</li>
</ul>




<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Variable Summary table, listing datasets and labels">
<caption><span><a name="variables"><!-- --></a>All commands</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" style="width:30px" scope="col">#</th>
<th class="colLast" width="100%" scope="col">content
<!-- <span style="float: right;">&nbsp;<a title="Raw Source" onclick="toggle('rawframe');setIframeHeight('rawframe');">raw</a> -->
</th>
<!--
<td style="display:none;" id="rawframe" rowspan="30" height="100%">
<iframe scrolling="yes" width="600px" height="100%" src="../files/i_import_delimited.ado.html#content" name="statdocSubFrame_raw" title="Raw File" style="height: 100%; width: 600px; overflow-x:scroll; overflow-y:scroll; -ms-overflow-x:scroll; -ms-overflow-y:scroll;"></iframe>
</td>
-->
</tr>
 <tr>
<td class="colFirst" style="width:30px"></td>
<td class="colLast" style="padding-left:0em"><div class="cmd_comment"> *! version 1.0.4  01jun2013</div></td>
</tr>
<tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="2" title="program"><!-- -->
    2</a>&nbsp;<a onclick='toggle("cmd_813921551");' title="program">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">program</span>
  <span class="cmdparameters"><a href="../tokens/d.html#define">define</a> <a href="../tokens/i.html#import_delimited">import_delimited</a></span>
<div id="cmd_813921551" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">*! version 1.0.4  01jun2013
program define import_delimited</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">program</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/d.html#define">define</a> <a href="../tokens/i.html#import_delimited">import_delimited</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="3" title="version"><!-- -->
    3</a>&nbsp;<a onclick='toggle("cmd_142828550");' title="version">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">version</span>
  <span class="cmdparameters">13</span>
<div id="cmd_142828550" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	version 13</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">version</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">13</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="5" title="gettoken"><!-- -->
    5</a>&nbsp;<a onclick='toggle("cmd_758849587");' title="gettoken">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">gettoken</span>
  <span class="cmdparameters"><a href="../tokens/f.html#filename">filename</a> <a href="../tokens/r.html#rest">rest</a> : 0</span>
, <span class="cmdoptions"> <a href="../tokens/p.html#parse">parse(</a>" ,")</span>
<div id="cmd_758849587" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	gettoken filename rest : 0, parse(" ,")</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">gettoken</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/p.html#parse">parse(</a>" ,")</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/f.html#filename">filename</a> <a href="../tokens/r.html#rest">rest</a> : 0</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="6" title="gettoken"><!-- -->
    6</a>&nbsp;<a onclick='toggle("cmd_-76220278");' title="gettoken">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">gettoken</span>
  <span class="cmdparameters"><a href="../tokens/c.html#comma">comma</a> : <a href="../tokens/r.html#rest">rest</a></span>
, <span class="cmdoptions"> <a href="../tokens/p.html#parse">parse(</a>" ,")</span>
<div id="cmd_-76220278" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	gettoken comma : rest, parse(" ,")</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">gettoken</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">options</td>
  <td class="colLast"> <a href="../tokens/p.html#parse">parse(</a>" ,")</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/c.html#comma">comma</a> : <a href="../tokens/r.html#rest">rest</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="8" title="if"><!-- -->
    8</a>&nbsp;<a onclick='toggle("cmd_611421710");' title="if">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">if</span>
  <span class="cmdparameters">(`"<a href="../tokens/f.html#filename">`filename'</a>"' != "" & (<a href="../tokens/t.html#trim">trim(</a>`"<a href="../tokens/c.html#comma">`comma'</a>"') == "," |		///
		<a href="../tokens/t.html#trim">trim(</a>`"<a href="../tokens/c.html#comma">`comma'</a>"') == "")) {</span>
<div id="cmd_611421710" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	if (`"`filename'"' != "" & (trim(`"`comma'"') == "," |		///
		trim(`"`comma'"') == "")) {</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">if</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">(`"<a href="../tokens/f.html#filename">`filename'</a>"' != "" & (<a href="../tokens/t.html#trim">trim(</a>`"<a href="../tokens/c.html#comma">`comma'</a>"') == "," |		///
		<a href="../tokens/t.html#trim">trim(</a>`"<a href="../tokens/c.html#comma">`comma'</a>"') == "")) {</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="10" title="local"><!-- -->
    10</a>&nbsp;<a onclick='toggle("cmd_1430209880");' title="local">[+]</a>
</td>
<td class="colLast" style="padding-left:4em">
 <span class="cmdcommand">local</span>
  <span class="cmdparameters">0 `"<a href="../tokens/u.html#using">using</a> `0'"'</span>
<div id="cmd_1430209880" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">		local 0 `"using `0'"'</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">local</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">2</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">0 `"<a href="../tokens/u.html#using">using</a> `0'"'</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="11" title="}"><!-- -->
    11</a>&nbsp;<a onclick='toggle("cmd_1529450916");' title="}">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">}</span>
  <span class="cmdparameters"></span>
<div id="cmd_1529450916" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	}</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">}</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="13" title="syntax"><!-- -->
    13</a>&nbsp;<a onclick='toggle("cmd_1849524884");' title="syntax">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdprefix"><a href="../tokens/c.html#capture">capture</a></span>
 <span class="cmdcommand">syntax</span>
  <span class="cmdparameters"> <a href="../tokens/u.html#using">using</a>/</span>
  <span class="cmdcomment">///
		[, DELIMiters(string asis)				///
		ROWRange(string)					///
		COLRange(string)					///
		VARNames(string)					///
		case(string)						///
		ASDOUBle						///
		ASFLOat							///
		clear							///
		BINDQuotes(string)					///
		STRIPQuotes(string)					///
		NUMERICCols(string)					///
		STRINGCols(string)					///
		COLLAPSEDelimiters]</span>
<div id="cmd_1849524884" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	capture syntax using/						///
		[, DELIMiters(string asis)				///
		ROWRange(string)					///
		COLRange(string)					///
		VARNames(string)					///
		case(string)						///
		ASDOUBle						///
		ASFLOat							///
		clear							///
		BINDQuotes(string)					///
		STRIPQuotes(string)					///
		NUMERICCols(string)					///
		STRINGCols(string)					///
		COLLAPSEDelimiters]</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">syntax</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">///
		[, DELIMiters(string asis)				///
		ROWRange(string)					///
		COLRange(string)					///
		VARNames(string)					///
		case(string)						///
		ASDOUBle						///
		ASFLOat							///
		clear							///
		BINDQuotes(string)					///
		STRIPQuotes(string)					///
		NUMERICCols(string)					///
		STRINGCols(string)					///
		COLLAPSEDelimiters]</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"> <a href="../tokens/u.html#using">using</a>/</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">prefix</td>
  <td class="colLast"><a href="../tokens/c.html#capture">capture</a></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="27" title="if"><!-- -->
    27</a>&nbsp;<a onclick='toggle("cmd_649492143");' title="if">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">if</span>
  <span class="cmdparameters"><a href="../tokens/_.html#_rc">_rc</a> {</span>
<div id="cmd_649492143" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	if _rc {</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">if</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"><a href="../tokens/_.html#_rc">_rc</a> {</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="28" title="syntax"><!-- -->
    28</a>&nbsp;<a onclick='toggle("cmd_212776906");' title="syntax">[+]</a>
</td>
<td class="colLast" style="padding-left:4em">
 <span class="cmdcommand">syntax</span>
  <span class="cmdparameters">[<a href="../tokens/a.html#anything">anything(</a><a href="../tokens/n.html#name">name</a>=<a href="../tokens/v.html#vlist">vlist</a> <a href="../tokens/i.html#id">id</a>="<a href="../tokens/v.html#vlist">vlist</a>")] <a href="../tokens/u.html#using">using</a>/</span>
  <span class="cmdcomment">///
			[, DELIMiters(string asis)			///
			ROWRange(string)				///
			COLRange(string)				///
			VARNames(string)				///
			case(string)					///
			ASDOUBle					///
			ASFLOat						///
			clear						///
			BINDQuotes(string)				///
			STRIPQuotes(string)				///
			NUMERICCols(string)				///
			STRINGCols(string)				///
			COLLAPSEDelimiters]</span>
<div id="cmd_212776906" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">		syntax [anything(name=vlist id="vlist")] using/		///
			[, DELIMiters(string asis)			///
			ROWRange(string)				///
			COLRange(string)				///
			VARNames(string)				///
			case(string)					///
			ASDOUBle					///
			ASFLOat						///
			clear						///
			BINDQuotes(string)				///
			STRIPQuotes(string)				///
			NUMERICCols(string)				///
			STRINGCols(string)				///
			COLLAPSEDelimiters]</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">syntax</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">///
			[, DELIMiters(string asis)			///
			ROWRange(string)				///
			COLRange(string)				///
			VARNames(string)				///
			case(string)					///
			ASDOUBle					///
			ASFLOat						///
			clear						///
			BINDQuotes(string)				///
			STRIPQuotes(string)				///
			NUMERICCols(string)				///
			STRINGCols(string)				///
			COLLAPSEDelimiters]</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">2</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">[<a href="../tokens/a.html#anything">anything(</a><a href="../tokens/n.html#name">name</a>=<a href="../tokens/v.html#vlist">vlist</a> <a href="../tokens/i.html#id">id</a>="<a href="../tokens/v.html#vlist">vlist</a>")] <a href="../tokens/u.html#using">using</a>/</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="42" title="}"><!-- -->
    42</a>&nbsp;<a onclick='toggle("cmd_701177712");' title="}">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">}</span>
  <span class="cmdparameters"></span>
<div id="cmd_701177712" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	}</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">}</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_other rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="44" title="mata:import_delim_import_file()"><!-- -->
    44</a>&nbsp;<a onclick='toggle("cmd_-1715486520");' title="mata:import_delim_import_file()">[+]</a>
</td>
<td class="colLast" style="padding-left:2em">
 <span class="cmdcommand">mata:import_delim_import_file()</span>
  <span class="cmdparameters"></span>
<div id="cmd_-1715486520" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">	mata:import_delim_import_file()</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata:import_delim_import_file()</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">1</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_blockcmd altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="46" title="end"><!-- -->
    46</a>&nbsp;<a onclick='toggle("cmd_1865630672");' title="end">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">end</span>
  <span class="cmdparameters"></span>
<div id="cmd_1865630672" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">end</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">parameters</td>
  <td class="colLast"></td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_systemcmd rowColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="48" title="version"><!-- -->
    48</a>&nbsp;<a onclick='toggle("cmd_1770027228");' title="version">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">version</span>
  <span class="cmdparameters">13.0</span>
<div id="cmd_1770027228" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">version 13.0</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="rowColor">
  <td class="colFirst">command</td>
  <td class="colLast">version</td>
  </tr>
       <tr class="altColor">
  <td class="colFirst">indent</td>
  <td class="colLast">0</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">parameters</td>
  <td class="colLast">13.0</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
 <tr class="cmd_mata altColor">
<td class="colFirst" style="width:30px;text-align:right;">
<a name="49" title="mata"><!-- -->
    49</a>&nbsp;<a onclick='toggle("cmd_901483227");' title="mata">[+]</a>
</td>
<td class="colLast" style="padding-left:0em">
 <span class="cmdcommand">mata</span>
  <span class="cmdcomment">block (728 lines)</span>
<div id="cmd_901483227" style="display:none">
<ul class="blockList">
<li class="blockList">
<pre class="wrap">
mata:
mata set matastrict on

struct _import_delim_parse_info {
	string scalar		filename
	string rowvector	varlist
	string scalar		op_delimiters
	string scalar		op_delimiters_collapse
	string scalar		op_delimiters_asstring
	string scalar		firstrow
	string scalar		op_case
	string scalar		op_bindquotes
	string scalar		op_stripquotes
	string scalar		op_numericcols
	string scalar		op_stringcols
	string scalar		op_varnames_row
	string scalar		start_row
	string scalar		end_row
	string scalar		start_col
	string scalar		end_col
	real scalar		op_asdouble
	real scalar		op_asfloat
	real scalar		op_clear
}

void import_delim_import_file()
{
	struct _import_delim_parse_info scalar pr

	import_delim_pr_init(pr)
	import_delim_parse_syntax(pr)
	import_delim_load_file(pr)
}

void import_delim_pr_init(struct _import_delim_parse_info scalar pr)
{
	pr.filename = ""
	pr.varlist = J(1,0,0)
	pr.op_delimiters = ""
	pr.op_delimiters_collapse = ""
	pr.op_delimiters_asstring = ""
	pr.firstrow = "auto"
	pr.op_case = "lower"
	pr.op_bindquotes = "loose"
	pr.op_stripquotes = "default"
	pr.op_numericcols = ""
	pr.op_stringcols = ""
	pr.op_varnames_row = ""
	pr.start_row = ""
	pr.end_row = ""
	pr.start_col = ""
	pr.end_col = ""
	pr.op_asdouble = .
	pr.op_asfloat = .
	pr.op_clear = .
}

void import_delim_parse_syntax(struct _import_delim_parse_info scalar pr)
{
	import_delim_check_file(pr)

	if (st_local("vlist") != "") {
		import_delim_check_varlist(pr)
	}

	if (st_local("delimiters") != "") {
		import_delim_parse_delimiters(pr)
	}

	if (st_local("rowrange") != "") {
		import_delim_parse_rowrange(pr)
	}

	if (st_local("colrange") != "") {
		import_delim_parse_colrange(pr)
	}

	if (st_local("varnames") != "") {
		import_delim_parse_varnames(pr)
	}

	if (st_local("numericcols") != "") {
		import_delim_parse_numericcols(pr)
	}

	if (st_local("stringcols") != "") {
		import_delim_parse_stringcols(pr)
	}

	if (pr.op_numericcols == "_all" & pr.op_stringcols == "_all") {
		errprintf("{bf:numericcols(all)} cannot be combined with ")
		errprintf("{bf:stringcols(all)}\n")
			exit(198)
	}

	if (st_local("case") != "") {
		import_delim_parse_case(pr)
	}
	else {
		if (st_global("c(importcase)")!="cmddefault") {
			pr.op_case = st_global("c(importcase)")
		}
	}

	if (st_local("bindquotes") != "") {
		import_delim_parse_bindquotes(pr)
	}

	if (st_local("stripquotes") != "") {
		import_delim_parse_stripquotes(pr)
	}

	pr.op_clear = (st_local("clear") != "")
	pr.op_asdouble = (st_local("asdouble") != "")
	pr.op_asfloat = (st_local("asfloat") != "")

	if (pr.op_asfloat & pr.op_asdouble) {
errprintf("{bf:asfloat()} and {bf:asdouble()} are mutually exclusive options\n")
		exit(198)
	}
}

void import_delim_check_file(struct _import_delim_parse_info scalar pr)
{
	string scalar		default_filetype
	string scalar		using_file, file, path
	string scalar		HoldPWD, basename
	real scalar		rc

	using_file = st_local("using")
	basename = pathbasename(using_file)

	if (basename=="") {
		errprintf("%s not a valid filename\n", using_file)
		exit(198)
	}

	if (pathisurl(using_file)) {
		pr.filename = st_tempfilename()
		rc =  _stata(sprintf(`"copy `"%s"' `"%s"'"', using_file,
			pr.filename))
		if (rc) {
			errprintf("could not open url\n")
			exit(603)
		}
		return
	}

	if (substr(using_file, 1, 1)=="~") {
		if (st_global("c(os)") != "Windows") {
			path = ""
			file = ""
			(void) pathsplit(using_file, path, file)
			HoldPWD = pwd()
			rc = _chdir(path)
			if (rc == 0) {
				path = pwd()
			}
			else {
				errprintf("invalid path :%s", path)
				exit(170)
			}
			chdir(HoldPWD)
			using_file = path + file
		}
	}

	default_filetype = ".csv"
	if (pathsuffix(using_file) == "") {
		using_file = using_file + default_filetype
	}

	if (!fileexists(using_file)) {
		errprintf("file %s not found\n", using_file)
		exit(601)
	}
	pr.filename = using_file
}

void import_delim_check_varlist(struct _import_delim_parse_info scalar pr)
{
	string rowvector	varlist
	real scalar		i

	varlist = tokens(st_local("vlist"))

	for (i=1; i<=cols(varlist); i++) {
		if (!st_isvarname(varlist[i])) {
			errprintf("{bf:%s}: invalid variable name\n",
				varlist[i])
			exit(198)
		}
	}

	pr.varlist = varlist
}

void import_delim_parse_delimiters(struct _import_delim_parse_info scalar pr)
{
	string scalar		delimiter, tmp
	real scalar		has_comma, has_quote
	transmorphic		t
	string scalar		shortcut, option

	delimiter = st_local("delimiters")

	has_comma = strpos(delimiter, ",")
	has_quote = strpos(delimiter, `"""')

	if (has_comma) {
		if (has_quote) {
			t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
			tokenset(t, delimiter)
			tmp = tokengetall(t)
			delimiter = tmp[1]
			if (strpos(delimiter, "\t")>0) {
				delimiter = subinstr(delimiter,"\t",char(9), .)
			}
			delimiter = import_delim_strip_quotes(delimiter)
			if (cols(tmp)>3) {
				errprintf("invalid {bf:delimiter()} argument\n")
				exit(198)
			}

			if (cols(tmp)==3) {
				option = strtrim(tmp[3])
			}

			if (option != "") {
				if (option == "collapse" | option == "colla" |
				option == "collap" | option == "collaps") {
					pr.op_delimiters_collapse = "TRUE"
				}
				else if (option == "asstring" |
				option == "asstr" | option == "asstri" |
				option == "asstrin") {
					pr.op_delimiters_asstring = "TRUE"
				}
				else {
errprintf("{bf:%s}: invalid {bf:delimiter()} argument\n", option)
					exit(198)
				}
			}
		}
		else {
			t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
			tokenset(t, delimiter)
			tmp = tokengetall(t)
			delimiter = strtrim(tmp[1])

			if (cols(tmp)>3) {
				errprintf("invalid {bf:delimiter()} argument\n")
				exit(198)
			}

			if (cols(tmp)==3) {
				option = strtrim(tmp[3])
			}
			else if (cols(tmp)==2 & tmp[1]==",") {
				option = strtrim(tmp[2])
			}

			delimiter = import_delim_check_shortcut(delimiter,
				has_quote)
			if (option == "collapse" | option == "colla" |
				option == "collap" | option == "collaps") {
				pr.op_delimiters_collapse = "TRUE"
			}
			else if (option == "asstring" | option == "asstr" |
				option == "asstri" | option == "asstrin") {
				pr.op_delimiters_asstring = "TRUE"
			}
			else {
errprintf("{bf:%s}: invalid {bf:delimiter()} argument; use {bf:collapse} or {bf:asstring}\n", option)
				exit(198)
			}
		}
	}
	else {
		t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
		tokenset(t, delimiter)
		shortcut = tokenget(t)
		delimiter = import_delim_check_shortcut(shortcut,
			has_quote)
		delimiter = import_delim_strip_quotes(delimiter)
	}
	pr.op_delimiters = delimiter
}

string scalar import_delim_check_shortcut(string scalar shortcut,
	real scalar has_quote)
{
	string scalar		delimiter, trim_shortcut


	if (strpos(shortcut, "\t")>0) {
		shortcut = subinstr(shortcut, "\t", char(9), .)
	}

	trim_shortcut = strtrim(shortcut)

	if (trim_shortcut == "tab") {
		delimiter = char(9)
	}
	else if (trim_shortcut == "comma") {
		delimiter = ","
	}
	else if (trim_shortcut == "space") {
		delimiter = " "
	}
	else if (strtrim(shortcut) == "whitespace") {
		delimiter = char(9) + " "
	}
	else {
		if (!has_quote & trim_shortcut != ",") {
errprintf("{bf:%s}: invalid {bf:delimiter()} shortcut\n", shortcut)
			exit(198)
		}
		delimiter = shortcut
	}

	return(delimiter)
}

string scalar import_delim_strip_quotes(string scalar value)
{
	string scalar		rev

	if (substr(value, 1, 1) == "`") {
		value = subinstr(value, "`", "", 1)
		value = subinstr(value, `"""', "", 1)
		rev = strreverse(value)
		rev = subinstr(rev, `"""', "", 1)
		rev = subinstr(rev, `"'"', "", 1)
		return(strreverse(rev))
	}
	if (substr(value, 1, 1) == `"""') {
		value = subinstr(value, `"""', "", 1)
		rev = strreverse(value)
		rev = subinstr(rev, `"""', "", 1)
		return(strreverse(rev))
	}
	return(value)
}


void import_delim_parse_rowrange(struct _import_delim_parse_info scalar pr)
{
	string scalar		rowrange, s_start_row, s_end_row
	real scalar		start_row, end_row

	rowrange = st_local("rowrange")

	if (strpos(rowrange, ":") & strpos(rowrange, ":") != 1) {
		s_start_row = substr(rowrange, 1, strpos(rowrange, ":")-1)
		if (strtrim(s_start_row) == "f") {
			start_row = 1
		}
		else {
			start_row = strtoreal(s_start_row)
		}
		if (start_row == . | start_row < 1 |
			strpos(s_start_row, ".") > 0) {
errprintf("{bf:%s} is an invalid start row in {bf:rowrange()} option\n",
	s_start_row)
			exit(198)
		}
		s_end_row = substr(rowrange, strpos(rowrange, ":")+1, .)
		if (strtrim(s_end_row) == "l") {
			end_row = .
		}
		else if (strtrim(substr(rowrange,
			strpos(rowrange, ":"), .))==":") {
			end_row = .
		}
		else {
			end_row = strtoreal(s_end_row)
			if (end_row == .) {
errprintf("{bf:%s}: invalid end row in {bf:rowrange()} option\n", s_end_row)
                        exit(198)
			}
		}

		if (start_row > end_row) {
errprintf("{bf:%s} is an invalid row range in {bf:rowrange()} option\n",
	rowrange)
errprintf("start row is greater than end row\n")
			exit(198)
		}

		pr.start_row = strofreal(start_row)
		pr.end_row = strofreal(end_row)
	}
	else if (strpos(rowrange, ":") == 1) {
		s_end_row = substr(rowrange, strpos(rowrange, ":")+1, .)
		end_row = strtoreal(s_end_row)
		if (end_row == . | end_row < 1 |
			strpos(s_end_row, ".") > 0) {
errprintf("{bf:%s}: invalid end row in {bf:rowrange()} option\n", s_end_row)
			exit(198)
		}
		pr.end_row = strofreal(end_row)
	}
	else {
		start_row = strtoreal(rowrange)
		if (start_row == . | start_row < 1 |
			strpos(rowrange, ".") > 0) {
errprintf("{bf:%s} is an invalid start row in {bf:rowrange()} option\n",
	rowrange)
			exit(198)
		}
		pr.start_row = strofreal(start_row)
	}
}

void import_delim_parse_colrange(struct _import_delim_parse_info scalar pr)
{
	string scalar		colrange, s_start_col, s_end_col
	real scalar		start_col, end_col

	colrange = st_local("colrange")

	if (strpos(colrange, ":") & strpos(colrange, ":") != 1) {
		s_start_col = substr(colrange, 1, strpos(colrange, ":")-1)
		if (strtrim(s_start_col) == "f") {
			start_col = 1
		}
		else {
			start_col = strtoreal(s_start_col)
		}
		if (start_col == . | start_col < 1 |
			strpos(s_start_col, ".") > 0) {
errprintf("{bf:%s} is an invalid start column in {bf:colrange()} option\n",
			s_start_col)
			exit(198)
		}

		s_end_col = substr(colrange, strpos(colrange, ":")+1, .)
		if (strtrim(s_end_col) == "l") {
			end_col = .
		}
		else if (strtrim(substr(colrange,
			strpos(colrange, ":"), .))==":") {
			end_col = .
		}
		else {
			end_col = strtoreal(s_end_col)
			if (end_col == .) {
errprintf("{bf:%s}: invalid end col in {bf:colrange()} option\n", s_end_col)
                        exit(198)
			}
		}

		if (start_col > end_col) {
errprintf("{bf:%s} is an invalid column range in {bf:colrange()} option\n",
	colrange)
errprintf("start column is greater than end column\n")
			exit(198)
		}

		pr.start_col = strofreal(start_col)
		pr.end_col = strofreal(end_col)
	}
	else if (strpos(colrange, ":") == 1 ) {
		s_end_col = substr(colrange, strpos(colrange, ":")+1, .)
		end_col = strtoreal(s_end_col)
		if (end_col == . | end_col < 1 |
			strpos(s_end_col, ".") > 0) {
errprintf("{bf:%s} is an invalid end column in {bf:colrange()} option\n",
	s_end_col)
			exit(198)
		}
		pr.end_col = strofreal(end_col)
	}
	else {
		start_col = strtoreal(colrange)
		if (start_col == . | start_col < 1 |
			strpos(colrange, ".") > 0) {
errprintf("{bf:%s} is an invalid start column in {bf:colrange()} option\n",
	colrange)
			exit(198)
		}
		pr.start_col = strofreal(start_col)
	}
}

void import_delim_parse_varnames(struct _import_delim_parse_info scalar pr)
{
	string scalar		varnames_row
	real scalar		start_row

	varnames_row = strtrim(st_local("varnames"))

	if (varnames_row == "non" |
		varnames_row == "nona" |
		varnames_row == "nonam" |
		varnames_row == "noname" |
		varnames_row == "nonames") {
		pr.firstrow = "no"
		return
	}

	start_row = strtoreal(varnames_row)
	if (start_row == . | start_row < 1 | strpos(varnames_row, ".") > 0) {
errprintf("{bf:%s}: invalid row number in {bf:varnames()} option\n",
		varnames_row)
		exit(198)
	}

	pr.op_varnames_row = varnames_row
}

void import_delim_parse_numericcols(struct _import_delim_parse_info scalar pr)
{
	string scalar		cols
	real scalar		rc

	cols = st_local("numericcols")

	if (strtrim(cols) == "_all") {
		pr.op_numericcols = strtrim(cols)
		return
	}

	rc = _stata(sprintf(`"qui numlist "%s", integer range(>0) sort"',
		cols), 1)
	if (rc) {
errprintf("{bf:%s}: invalid numlist in {bf:numericcols()} option\n", cols)
		exit(198)
	}
	pr.op_numericcols = st_global("r(numlist)")
}

void import_delim_parse_stringcols(struct _import_delim_parse_info scalar pr)
{
	string scalar		cols
	real scalar		rc

	cols = st_local("stringcols")

	if (strtrim(cols) == "_all") {
		pr.op_stringcols = strtrim(cols)
		return
	}

	rc = _stata(sprintf(`"qui numlist "%s", integer range(>0) sort"',
		cols), 1)
	if (rc) {
errprintf("{bf:%s}: invalid numlist in {bf:stringcols()} option\n", cols)
		exit(198)
	}
	pr.op_stringcols = st_global("r(numlist)")
}

void import_delim_parse_case(struct _import_delim_parse_info scalar pr)
{
	string scalar		lcase

	lcase = st_local("case")

	if (lcase == "l" | lcase == "lo" | lcase == "low" | lcase == "lowe"
		| lcase == "lower") {
		pr.op_case = "lower"
	}
	else if (lcase == "u" | lcase == "up" | lcase == "upp" | lcase == "uppe"
		| lcase == "upper") {
		pr.op_case = "upper"
	}
	else if (lcase == "pre" | lcase == "pres" | lcase == "prese" |
		lcase == "preser" | lcase == "preserv" | lcase == "preserve") {
		pr.op_case = "preserve"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:case()} argument;  ",
			lcase)
		errprintf("use {bf:upper}, {bf:lower}, or {bf:preserve}\n")
		exit(198)
	}
}

void import_delim_parse_bindquotes(struct _import_delim_parse_info scalar pr)
{
	string scalar		bquote

	bquote = st_local("bindquotes")

	if (bquote == "l" | bquote == "lo" | bquote == "loo" | bquote == "loos"
		| bquote == "loose") {
		pr.op_bindquotes = "loose"
	}
	else if (bquote == "s" | bquote == "st" | bquote == "str"
		| bquote == "stri" | bquote == "stric" | bquote == "strict") {
		pr.op_bindquotes = "strict"
	}
	else if (bquote == "nob" | bquote == "nobi" | bquote == "nobin" |
		bquote == "nobind") {
		pr.op_bindquotes = "nobind"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:bindquotes()} argument; ",
			bquote)
		errprintf("use {bf:loose}, {bf:strict}, or {bf:nobind}\n")
		exit(198)
	}
}

void import_delim_parse_stripquotes(struct _import_delim_parse_info scalar pr)
{
	string scalar		squote

	squote = st_local("stripquotes")

	if (squote == "y" | squote == "ye" | squote == "yes") {
		pr.op_stripquotes = "yes"
	}
	else if (squote == "n" | squote == "no") {
		pr.op_stripquotes = "no"
	}
	else if (squote == "def" | squote == "defa" | squote == "defau" |
		squote == "defaul" | squote == "default") {
		pr.op_stripquotes = "nobind"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:stripquotes()} argument; ",
			squote)
		errprintf("use {bf:yes}, {bf:no}, or {bf:default}\n")
		exit(198)
	}
}

void import_delim_load_file(struct _import_delim_parse_info scalar pr)
{
	real scalar		rc, i
	string scalar		varname, vtype

	if ((st_numscalar("c(changed)") | st_nobs() | st_nvar()) &
		!pr.op_clear) {
		errprintf("no; data in memory would be lost\n")
		exit(4)
	}

	vtype = st_global("c(type)")

	if (pr.op_asdouble) {
		stata("set type double")
	}
	else if (pr.op_asfloat) {
		stata("set type float")
	}

	stata("preserve", 1)
	if (pr.op_clear) {
		stata("clear", 1)
	}

	/* Debugging */
/*
	printf("j_filename=|%s|\n", pr.filename)
	printf("j_vRange1=|%s|\n", pr.start_row)
	printf("j_vRange2=|%s|\n", pr.end_row)
	printf("j_hRange1=|%s|\n", pr.start_col)
	printf("j_hRange2=|%s|\n", pr.end_col)
	printf("j_caseType=|%s|\n", pr.op_case)
	printf("j_delimiter=|%s|\n", pr.op_delimiters)
	printf("j_firstrow=|%s|\n", pr.firstrow)
	printf("j_varnamerow=|%s|\n", pr.op_varnames_row)
	printf("j_bindquotes=|%s|\n", pr.op_bindquotes)
	printf("j_stripquotes=|%s|\n", pr.op_stripquotes)
	printf("j_sequential=|%s|\n", pr.op_delimiters_collapse)
	printf("j_multichardelim=|%s|\n", pr.op_delimiters_asstring)
	printf("j_numvars=|%s|\n", pr.op_numericcols)
	printf("j_strvars=|%s|\n", pr.op_stringcols)
*/

	/* Fill in local macros that will be parsed in
	 * StImportDelimited, main()
	 */

	st_local("j_filename", pr.filename)
	st_local("j_vRange1", pr.start_row)		// #
	st_local("j_vRange2", pr.end_row)		// #
	st_local("j_hRange1", pr.start_col)		// #
	st_local("j_hRange2", pr.end_col)		// #
	st_local("j_caseType", pr.op_case)		// lower|upper|preserve
	st_local("j_delimiter", pr.op_delimiters)	// chars
	st_local("j_firstrow", pr.firstrow)		// yes|no|auto
	st_local("j_varnamerow", pr.op_varnames_row)	// #
	st_local("j_bindquotes", pr.op_bindquotes)	// loose|strict|no
	st_local("j_stripquotes", pr.op_stripquotes)	// auto|yes|no
	st_local("j_sequential", pr.op_delimiters_collapse) // empty or not
	st_local("j_multichardelim", pr.op_delimiters_asstring) // empty or not
	st_local("j_numvars", pr.op_numericcols)	// <numlist>, _all
	st_local("j_strvars", pr.op_stringcols)		// <numlist>, _all

	rc = _stata("javacall com.stata.StImportDelimited main")
	if (rc) {
		exit(rc)
	}

	if (cols(pr.varlist) > st_nvar()) {
		stata("restore", 1)
		stata(sprintf("set type %s", vtype), 1)
		errprintf("too many variables specified\n")
		exit(103)
	}
	for(i=1; i<=cols(pr.varlist); i++) {
		varname = st_varname(i)
		rc = _stata(sprintf("rename %s %s", varname, pr.varlist[i]), 1)
		if (rc) {
			errprintf("could not name variables specified\n")
			exit(198)
		}
	}

	stata(sprintf("set type %s", vtype))

	if (rc == 0) {
		stata("restore, not", 1)
	}
	if (st_nvar() == 1) {
		printf("{text}(%f var, %f obs)", st_nvar(), st_nobs())
	}
	else {
		printf("{text}(%f vars, %f obs)", st_nvar(), st_nobs())
	}
}

end</pre>
</li>
</ul>
  <table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties">
  <caption><span><a name="properties"><!-- --></a>All properties</span><span class="tabEnd">&nbsp;</span></caption>
  <tr>
  <th class="colFirst" scope="col">key</th>
  <th class="colLast"  scope="col">content</th>
  </tr>
  <tbody>
       <tr class="altColor">
  <td class="colFirst">command</td>
  <td class="colLast">mata</td>
  </tr>
       <tr class="rowColor">
  <td class="colFirst">comment</td>
  <td class="colLast">block (728 lines)</td>
  </tr>
    </tbody>
  </table>
<br>
</br>

</div>
</td>
</tr>
</table>
</li>
</ul>


<a name="content"><!--   --></a>
<!-- ========== CONTENT =========== -->
<ul class="blockList">
<li class="blockList">
<ul class="blockList">
<li class="blockList">
<h3>Content</h3>
<pre>
*! version 1.0.4  01jun2013
program define import_delimited
	version 13

	gettoken filename rest : 0, parse(" ,")
	gettoken comma : rest, parse(" ,")

	if (`"`filename'"' != "" & (trim(`"`comma'"') == "," |		///
		trim(`"`comma'"') == "")) {
		local 0 `"using `0'"'
	}

	capture syntax using/						///
		[, DELIMiters(string asis)				///
		ROWRange(string)					///
		COLRange(string)					///
		VARNames(string)					///
		case(string)						///
		ASDOUBle						///
		ASFLOat							///
		clear							///
		BINDQuotes(string)					///
		STRIPQuotes(string)					///
		NUMERICCols(string)					///
		STRINGCols(string)					///
		COLLAPSEDelimiters]
	if _rc {
		syntax [anything(name=vlist id="vlist")] using/		///
			[, DELIMiters(string asis)			///
			ROWRange(string)				///
			COLRange(string)				///
			VARNames(string)				///
			case(string)					///
			ASDOUBle					///
			ASFLOat						///
			clear						///
			BINDQuotes(string)				///
			STRIPQuotes(string)				///
			NUMERICCols(string)				///
			STRINGCols(string)				///
			COLLAPSEDelimiters]
	}

	mata:import_delim_import_file()

end

version 13.0
mata:
mata set matastrict on

struct _import_delim_parse_info {
	string scalar		filename
	string rowvector	varlist
	string scalar		op_delimiters
	string scalar		op_delimiters_collapse
	string scalar		op_delimiters_asstring
	string scalar		firstrow
	string scalar		op_case
	string scalar		op_bindquotes
	string scalar		op_stripquotes
	string scalar		op_numericcols
	string scalar		op_stringcols
	string scalar		op_varnames_row
	string scalar		start_row
	string scalar		end_row
	string scalar		start_col
	string scalar		end_col
	real scalar		op_asdouble
	real scalar		op_asfloat
	real scalar		op_clear
}

void import_delim_import_file()
{
	struct _import_delim_parse_info scalar pr

	import_delim_pr_init(pr)
	import_delim_parse_syntax(pr)
	import_delim_load_file(pr)
}

void import_delim_pr_init(struct _import_delim_parse_info scalar pr)
{
	pr.filename = ""
	pr.varlist = J(1,0,0)
	pr.op_delimiters = ""
	pr.op_delimiters_collapse = ""
	pr.op_delimiters_asstring = ""
	pr.firstrow = "auto"
	pr.op_case = "lower"
	pr.op_bindquotes = "loose"
	pr.op_stripquotes = "default"
	pr.op_numericcols = ""
	pr.op_stringcols = ""
	pr.op_varnames_row = ""
	pr.start_row = ""
	pr.end_row = ""
	pr.start_col = ""
	pr.end_col = ""
	pr.op_asdouble = .
	pr.op_asfloat = .
	pr.op_clear = .
}

void import_delim_parse_syntax(struct _import_delim_parse_info scalar pr)
{
	import_delim_check_file(pr)

	if (st_local("vlist") != "") {
		import_delim_check_varlist(pr)
	}

	if (st_local("delimiters") != "") {
		import_delim_parse_delimiters(pr)
	}

	if (st_local("rowrange") != "") {
		import_delim_parse_rowrange(pr)
	}

	if (st_local("colrange") != "") {
		import_delim_parse_colrange(pr)
	}

	if (st_local("varnames") != "") {
		import_delim_parse_varnames(pr)
	}

	if (st_local("numericcols") != "") {
		import_delim_parse_numericcols(pr)
	}

	if (st_local("stringcols") != "") {
		import_delim_parse_stringcols(pr)
	}

	if (pr.op_numericcols == "_all" & pr.op_stringcols == "_all") {
		errprintf("{bf:numericcols(all)} cannot be combined with ")
		errprintf("{bf:stringcols(all)}\n")
			exit(198)
	}

	if (st_local("case") != "") {
		import_delim_parse_case(pr)
	}
	else {
		if (st_global("c(importcase)")!="cmddefault") {
			pr.op_case = st_global("c(importcase)")
		}
	}

	if (st_local("bindquotes") != "") {
		import_delim_parse_bindquotes(pr)
	}

	if (st_local("stripquotes") != "") {
		import_delim_parse_stripquotes(pr)
	}

	pr.op_clear = (st_local("clear") != "")
	pr.op_asdouble = (st_local("asdouble") != "")
	pr.op_asfloat = (st_local("asfloat") != "")

	if (pr.op_asfloat & pr.op_asdouble) {
errprintf("{bf:asfloat()} and {bf:asdouble()} are mutually exclusive options\n")
		exit(198)
	}
}

void import_delim_check_file(struct _import_delim_parse_info scalar pr)
{
	string scalar		default_filetype
	string scalar		using_file, file, path
	string scalar		HoldPWD, basename
	real scalar		rc

	using_file = st_local("using")
	basename = pathbasename(using_file)

	if (basename=="") {
		errprintf("%s not a valid filename\n", using_file)
		exit(198)
	}

	if (pathisurl(using_file)) {
		pr.filename = st_tempfilename()
		rc =  _stata(sprintf(`"copy `"%s"' `"%s"'"', using_file,
			pr.filename))
		if (rc) {
			errprintf("could not open url\n")
			exit(603)
		}
		return
	}

	if (substr(using_file, 1, 1)=="~") {
		if (st_global("c(os)") != "Windows") {
			path = ""
			file = ""
			(void) pathsplit(using_file, path, file)
			HoldPWD = pwd()
			rc = _chdir(path)
			if (rc == 0) {
				path = pwd()
			}
			else {
				errprintf("invalid path :%s", path)
				exit(170)
			}
			chdir(HoldPWD)
			using_file = path + file
		}
	}

	default_filetype = ".csv"
	if (pathsuffix(using_file) == "") {
		using_file = using_file + default_filetype
	}

	if (!fileexists(using_file)) {
		errprintf("file %s not found\n", using_file)
		exit(601)
	}
	pr.filename = using_file
}

void import_delim_check_varlist(struct _import_delim_parse_info scalar pr)
{
	string rowvector	varlist
	real scalar		i

	varlist = tokens(st_local("vlist"))

	for (i=1; i<=cols(varlist); i++) {
		if (!st_isvarname(varlist[i])) {
			errprintf("{bf:%s}: invalid variable name\n",
				varlist[i])
			exit(198)
		}
	}

	pr.varlist = varlist
}

void import_delim_parse_delimiters(struct _import_delim_parse_info scalar pr)
{
	string scalar		delimiter, tmp
	real scalar		has_comma, has_quote
	transmorphic		t
	string scalar		shortcut, option

	delimiter = st_local("delimiters")

	has_comma = strpos(delimiter, ",")
	has_quote = strpos(delimiter, `"""')

	if (has_comma) {
		if (has_quote) {
			t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
			tokenset(t, delimiter)
			tmp = tokengetall(t)
			delimiter = tmp[1]
			if (strpos(delimiter, "\t")>0) {
				delimiter = subinstr(delimiter,"\t",char(9), .)
			}
			delimiter = import_delim_strip_quotes(delimiter)
			if (cols(tmp)>3) {
				errprintf("invalid {bf:delimiter()} argument\n")
				exit(198)
			}

			if (cols(tmp)==3) {
				option = strtrim(tmp[3])
			}

			if (option != "") {
				if (option == "collapse" | option == "colla" |
				option == "collap" | option == "collaps") {
					pr.op_delimiters_collapse = "TRUE"
				}
				else if (option == "asstring" |
				option == "asstr" | option == "asstri" |
				option == "asstrin") {
					pr.op_delimiters_asstring = "TRUE"
				}
				else {
errprintf("{bf:%s}: invalid {bf:delimiter()} argument\n", option)
					exit(198)
				}
			}
		}
		else {
			t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
			tokenset(t, delimiter)
			tmp = tokengetall(t)
			delimiter = strtrim(tmp[1])

			if (cols(tmp)>3) {
				errprintf("invalid {bf:delimiter()} argument\n")
				exit(198)
			}

			if (cols(tmp)==3) {
				option = strtrim(tmp[3])
			}
			else if (cols(tmp)==2 & tmp[1]==",") {
				option = strtrim(tmp[2])
			}

			delimiter = import_delim_check_shortcut(delimiter,
				has_quote)
			if (option == "collapse" | option == "colla" |
				option == "collap" | option == "collaps") {
				pr.op_delimiters_collapse = "TRUE"
			}
			else if (option == "asstring" | option == "asstr" |
				option == "asstri" | option == "asstrin") {
				pr.op_delimiters_asstring = "TRUE"
			}
			else {
errprintf("{bf:%s}: invalid {bf:delimiter()} argument; use {bf:collapse} or {bf:asstring}\n", option)
				exit(198)
			}
		}
	}
	else {
		t = tokeninit("", `","', (`""""', `"`""'"'), 0, 0)
		tokenset(t, delimiter)
		shortcut = tokenget(t)
		delimiter = import_delim_check_shortcut(shortcut,
			has_quote)
		delimiter = import_delim_strip_quotes(delimiter)
	}
	pr.op_delimiters = delimiter
}

string scalar import_delim_check_shortcut(string scalar shortcut,
	real scalar has_quote)
{
	string scalar		delimiter, trim_shortcut


	if (strpos(shortcut, "\t")>0) {
		shortcut = subinstr(shortcut, "\t", char(9), .)
	}

	trim_shortcut = strtrim(shortcut)

	if (trim_shortcut == "tab") {
		delimiter = char(9)
	}
	else if (trim_shortcut == "comma") {
		delimiter = ","
	}
	else if (trim_shortcut == "space") {
		delimiter = " "
	}
	else if (strtrim(shortcut) == "whitespace") {
		delimiter = char(9) + " "
	}
	else {
		if (!has_quote & trim_shortcut != ",") {
errprintf("{bf:%s}: invalid {bf:delimiter()} shortcut\n", shortcut)
			exit(198)
		}
		delimiter = shortcut
	}

	return(delimiter)
}

string scalar import_delim_strip_quotes(string scalar value)
{
	string scalar		rev

	if (substr(value, 1, 1) == "`") {
		value = subinstr(value, "`", "", 1)
		value = subinstr(value, `"""', "", 1)
		rev = strreverse(value)
		rev = subinstr(rev, `"""', "", 1)
		rev = subinstr(rev, `"'"', "", 1)
		return(strreverse(rev))
	}
	if (substr(value, 1, 1) == `"""') {
		value = subinstr(value, `"""', "", 1)
		rev = strreverse(value)
		rev = subinstr(rev, `"""', "", 1)
		return(strreverse(rev))
	}
	return(value)
}


void import_delim_parse_rowrange(struct _import_delim_parse_info scalar pr)
{
	string scalar		rowrange, s_start_row, s_end_row
	real scalar		start_row, end_row

	rowrange = st_local("rowrange")

	if (strpos(rowrange, ":") & strpos(rowrange, ":") != 1) {
		s_start_row = substr(rowrange, 1, strpos(rowrange, ":")-1)
		if (strtrim(s_start_row) == "f") {
			start_row = 1
		}
		else {
			start_row = strtoreal(s_start_row)
		}
		if (start_row == . | start_row < 1 |
			strpos(s_start_row, ".") > 0) {
errprintf("{bf:%s} is an invalid start row in {bf:rowrange()} option\n",
	s_start_row)
			exit(198)
		}
		s_end_row = substr(rowrange, strpos(rowrange, ":")+1, .)
		if (strtrim(s_end_row) == "l") {
			end_row = .
		}
		else if (strtrim(substr(rowrange,
			strpos(rowrange, ":"), .))==":") {
			end_row = .
		}
		else {
			end_row = strtoreal(s_end_row)
			if (end_row == .) {
errprintf("{bf:%s}: invalid end row in {bf:rowrange()} option\n", s_end_row)
                        exit(198)
			}
		}

		if (start_row > end_row) {
errprintf("{bf:%s} is an invalid row range in {bf:rowrange()} option\n",
	rowrange)
errprintf("start row is greater than end row\n")
			exit(198)
		}

		pr.start_row = strofreal(start_row)
		pr.end_row = strofreal(end_row)
	}
	else if (strpos(rowrange, ":") == 1) {
		s_end_row = substr(rowrange, strpos(rowrange, ":")+1, .)
		end_row = strtoreal(s_end_row)
		if (end_row == . | end_row < 1 |
			strpos(s_end_row, ".") > 0) {
errprintf("{bf:%s}: invalid end row in {bf:rowrange()} option\n", s_end_row)
			exit(198)
		}
		pr.end_row = strofreal(end_row)
	}
	else {
		start_row = strtoreal(rowrange)
		if (start_row == . | start_row < 1 |
			strpos(rowrange, ".") > 0) {
errprintf("{bf:%s} is an invalid start row in {bf:rowrange()} option\n",
	rowrange)
			exit(198)
		}
		pr.start_row = strofreal(start_row)
	}
}

void import_delim_parse_colrange(struct _import_delim_parse_info scalar pr)
{
	string scalar		colrange, s_start_col, s_end_col
	real scalar		start_col, end_col

	colrange = st_local("colrange")

	if (strpos(colrange, ":") & strpos(colrange, ":") != 1) {
		s_start_col = substr(colrange, 1, strpos(colrange, ":")-1)
		if (strtrim(s_start_col) == "f") {
			start_col = 1
		}
		else {
			start_col = strtoreal(s_start_col)
		}
		if (start_col == . | start_col < 1 |
			strpos(s_start_col, ".") > 0) {
errprintf("{bf:%s} is an invalid start column in {bf:colrange()} option\n",
			s_start_col)
			exit(198)
		}

		s_end_col = substr(colrange, strpos(colrange, ":")+1, .)
		if (strtrim(s_end_col) == "l") {
			end_col = .
		}
		else if (strtrim(substr(colrange,
			strpos(colrange, ":"), .))==":") {
			end_col = .
		}
		else {
			end_col = strtoreal(s_end_col)
			if (end_col == .) {
errprintf("{bf:%s}: invalid end col in {bf:colrange()} option\n", s_end_col)
                        exit(198)
			}
		}

		if (start_col > end_col) {
errprintf("{bf:%s} is an invalid column range in {bf:colrange()} option\n",
	colrange)
errprintf("start column is greater than end column\n")
			exit(198)
		}

		pr.start_col = strofreal(start_col)
		pr.end_col = strofreal(end_col)
	}
	else if (strpos(colrange, ":") == 1 ) {
		s_end_col = substr(colrange, strpos(colrange, ":")+1, .)
		end_col = strtoreal(s_end_col)
		if (end_col == . | end_col < 1 |
			strpos(s_end_col, ".") > 0) {
errprintf("{bf:%s} is an invalid end column in {bf:colrange()} option\n",
	s_end_col)
			exit(198)
		}
		pr.end_col = strofreal(end_col)
	}
	else {
		start_col = strtoreal(colrange)
		if (start_col == . | start_col < 1 |
			strpos(colrange, ".") > 0) {
errprintf("{bf:%s} is an invalid start column in {bf:colrange()} option\n",
	colrange)
			exit(198)
		}
		pr.start_col = strofreal(start_col)
	}
}

void import_delim_parse_varnames(struct _import_delim_parse_info scalar pr)
{
	string scalar		varnames_row
	real scalar		start_row

	varnames_row = strtrim(st_local("varnames"))

	if (varnames_row == "non" |
		varnames_row == "nona" |
		varnames_row == "nonam" |
		varnames_row == "noname" |
		varnames_row == "nonames") {
		pr.firstrow = "no"
		return
	}

	start_row = strtoreal(varnames_row)
	if (start_row == . | start_row < 1 | strpos(varnames_row, ".") > 0) {
errprintf("{bf:%s}: invalid row number in {bf:varnames()} option\n",
		varnames_row)
		exit(198)
	}

	pr.op_varnames_row = varnames_row
}

void import_delim_parse_numericcols(struct _import_delim_parse_info scalar pr)
{
	string scalar		cols
	real scalar		rc

	cols = st_local("numericcols")

	if (strtrim(cols) == "_all") {
		pr.op_numericcols = strtrim(cols)
		return
	}

	rc = _stata(sprintf(`"qui numlist "%s", integer range(>0) sort"',
		cols), 1)
	if (rc) {
errprintf("{bf:%s}: invalid numlist in {bf:numericcols()} option\n", cols)
		exit(198)
	}
	pr.op_numericcols = st_global("r(numlist)")
}

void import_delim_parse_stringcols(struct _import_delim_parse_info scalar pr)
{
	string scalar		cols
	real scalar		rc

	cols = st_local("stringcols")

	if (strtrim(cols) == "_all") {
		pr.op_stringcols = strtrim(cols)
		return
	}

	rc = _stata(sprintf(`"qui numlist "%s", integer range(>0) sort"',
		cols), 1)
	if (rc) {
errprintf("{bf:%s}: invalid numlist in {bf:stringcols()} option\n", cols)
		exit(198)
	}
	pr.op_stringcols = st_global("r(numlist)")
}

void import_delim_parse_case(struct _import_delim_parse_info scalar pr)
{
	string scalar		lcase

	lcase = st_local("case")

	if (lcase == "l" | lcase == "lo" | lcase == "low" | lcase == "lowe"
		| lcase == "lower") {
		pr.op_case = "lower"
	}
	else if (lcase == "u" | lcase == "up" | lcase == "upp" | lcase == "uppe"
		| lcase == "upper") {
		pr.op_case = "upper"
	}
	else if (lcase == "pre" | lcase == "pres" | lcase == "prese" |
		lcase == "preser" | lcase == "preserv" | lcase == "preserve") {
		pr.op_case = "preserve"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:case()} argument;  ",
			lcase)
		errprintf("use {bf:upper}, {bf:lower}, or {bf:preserve}\n")
		exit(198)
	}
}

void import_delim_parse_bindquotes(struct _import_delim_parse_info scalar pr)
{
	string scalar		bquote

	bquote = st_local("bindquotes")

	if (bquote == "l" | bquote == "lo" | bquote == "loo" | bquote == "loos"
		| bquote == "loose") {
		pr.op_bindquotes = "loose"
	}
	else if (bquote == "s" | bquote == "st" | bquote == "str"
		| bquote == "stri" | bquote == "stric" | bquote == "strict") {
		pr.op_bindquotes = "strict"
	}
	else if (bquote == "nob" | bquote == "nobi" | bquote == "nobin" |
		bquote == "nobind") {
		pr.op_bindquotes = "nobind"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:bindquotes()} argument; ",
			bquote)
		errprintf("use {bf:loose}, {bf:strict}, or {bf:nobind}\n")
		exit(198)
	}
}

void import_delim_parse_stripquotes(struct _import_delim_parse_info scalar pr)
{
	string scalar		squote

	squote = st_local("stripquotes")

	if (squote == "y" | squote == "ye" | squote == "yes") {
		pr.op_stripquotes = "yes"
	}
	else if (squote == "n" | squote == "no") {
		pr.op_stripquotes = "no"
	}
	else if (squote == "def" | squote == "defa" | squote == "defau" |
		squote == "defaul" | squote == "default") {
		pr.op_stripquotes = "nobind"
	}
	else {
		errprintf("{bf:%s} is an invalid {bf:stripquotes()} argument; ",
			squote)
		errprintf("use {bf:yes}, {bf:no}, or {bf:default}\n")
		exit(198)
	}
}

void import_delim_load_file(struct _import_delim_parse_info scalar pr)
{
	real scalar		rc, i
	string scalar		varname, vtype

	if ((st_numscalar("c(changed)") | st_nobs() | st_nvar()) &
		!pr.op_clear) {
		errprintf("no; data in memory would be lost\n")
		exit(4)
	}

	vtype = st_global("c(type)")

	if (pr.op_asdouble) {
		stata("set type double")
	}
	else if (pr.op_asfloat) {
		stata("set type float")
	}

	stata("preserve", 1)
	if (pr.op_clear) {
		stata("clear", 1)
	}

	/* Debugging */
/*
	printf("j_filename=|%s|\n", pr.filename)
	printf("j_vRange1=|%s|\n", pr.start_row)
	printf("j_vRange2=|%s|\n", pr.end_row)
	printf("j_hRange1=|%s|\n", pr.start_col)
	printf("j_hRange2=|%s|\n", pr.end_col)
	printf("j_caseType=|%s|\n", pr.op_case)
	printf("j_delimiter=|%s|\n", pr.op_delimiters)
	printf("j_firstrow=|%s|\n", pr.firstrow)
	printf("j_varnamerow=|%s|\n", pr.op_varnames_row)
	printf("j_bindquotes=|%s|\n", pr.op_bindquotes)
	printf("j_stripquotes=|%s|\n", pr.op_stripquotes)
	printf("j_sequential=|%s|\n", pr.op_delimiters_collapse)
	printf("j_multichardelim=|%s|\n", pr.op_delimiters_asstring)
	printf("j_numvars=|%s|\n", pr.op_numericcols)
	printf("j_strvars=|%s|\n", pr.op_stringcols)
*/

	/* Fill in local macros that will be parsed in
	 * StImportDelimited, main()
	 */

	st_local("j_filename", pr.filename)
	st_local("j_vRange1", pr.start_row)		// #
	st_local("j_vRange2", pr.end_row)		// #
	st_local("j_hRange1", pr.start_col)		// #
	st_local("j_hRange2", pr.end_col)		// #
	st_local("j_caseType", pr.op_case)		// lower|upper|preserve
	st_local("j_delimiter", pr.op_delimiters)	// chars
	st_local("j_firstrow", pr.firstrow)		// yes|no|auto
	st_local("j_varnamerow", pr.op_varnames_row)	// #
	st_local("j_bindquotes", pr.op_bindquotes)	// loose|strict|no
	st_local("j_stripquotes", pr.op_stripquotes)	// auto|yes|no
	st_local("j_sequential", pr.op_delimiters_collapse) // empty or not
	st_local("j_multichardelim", pr.op_delimiters_asstring) // empty or not
	st_local("j_numvars", pr.op_numericcols)	// <numlist>, _all
	st_local("j_strvars", pr.op_stringcols)		// <numlist>, _all

	rc = _stata("javacall com.stata.StImportDelimited main")
	if (rc) {
		exit(rc)
	}

	if (cols(pr.varlist) > st_nvar()) {
		stata("restore", 1)
		stata(sprintf("set type %s", vtype), 1)
		errprintf("too many variables specified\n")
		exit(103)
	}
	for(i=1; i<=cols(pr.varlist); i++) {
		varname = st_varname(i)
		rc = _stata(sprintf("rename %s %s", varname, pr.varlist[i]), 1)
		if (rc) {
			errprintf("could not name variables specified\n")
			exit(198)
		}
	}

	stata(sprintf("set type %s", vtype))

	if (rc == 0) {
		stata("restore, not", 1)
	}
	if (st_nvar() == 1) {
		printf("{text}(%f var, %f obs)", st_nvar(), st_nobs())
	}
	else {
		printf("{text}(%f vars, %f obs)", st_nvar(), st_nobs())
	}
}

end


</pre>
</li>
</ul>
</li>
</ul>


<ul class="blockList">
<li class="blockList">
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== TOKENS =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Tokens</h3>
 <span style="font-size: 24pt;"><a class="tokens" href="../tokens/a.html#ado">ado</a></span>&nbsp;&nbsp;
<span style="font-size: 17pt;"><a class="tokens" href="../tokens/d.html#delimited">delimited</a></span>&nbsp;&nbsp;
<span style="font-size: 8pt;"><a class="tokens" href="../tokens/d.html#delimited_ado">delimited ado</a></span>&nbsp;&nbsp;
 <span style="font-size: 24pt;"><a class="tokens" href="../tokens/i.html#import">import</a></span>&nbsp;&nbsp;
<span style="font-size: 10pt;"><a class="tokens" href="../tokens/i.html#import_delimited">import delimited</a></span>&nbsp;&nbsp;
</li>
</ul>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ========= START OF BOTTOM NAVBAR ========= -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li ><a href="../overview/overview-summary.html"  target="classFrame">Overview</a></li>
<li ><a href="../variables/variables-summary.html"  target="classFrame">Variables</a></li>
<li  class="navBarCell1Rev"><a href="../files/files-summary.html"  target="classFrame">Files</a></li>
<li ><a href="../tokens/tokens-summary.html"  target="classFrame">Tokens</a></li>
<!-- <li><a href="../flows/flow-summary.html"  target="classFrame">Flows</a></li> -->
<li ><a href="../overview/help-doc.html"  target="classFrame">Help</a></li>
<!-- <li class="navBarCell1Rev">Active</li> -->
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>
	<a href="../files/i_import.sthlp.html" title="i/import.sthlp">Prev</a>	
	</li>
<li>
    <a href="../files/i_import_delimited.sthlp.html" title="i/import_delimited.sthlp" >Next</a>   
    </li>
</ul>
<ul class="navList">
<li><a href="../index.html?files/i_import_delimited.ado.html" target="_top">Frames</a></li>
<li><a href="../files/i_import_delimited.ado.html" target="_top">No Frames</a></li>
</ul>


<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ========= END OF BOTTOM NAVBAR ========= -->
</body>
</html>